---
created: 2025-11-06
updated: 2025-11-06
---

# Codex JSONL Log Format

This document describes the JSONL (JSON Lines) log file format generated by Codex CLI.

## Overview

Codex CLI saves each session as a JSONL file in `~/.codex/sessions/`. Each line is an independent JSON object representing a single event or message.

## File Structure

### Directory Layout

```
~/.codex/sessions/
└── YYYY/
    └── MM/
        └── DD/
            └── <session-id>.jsonl
```

Example:

```
~/.codex/sessions/
└── 2025/
    └── 01/
        └── 15/
            └── 0193a4b2-8c90-7d4e-a123-456789abcdef.jsonl
```

### Session ID

Session IDs are in UUID format (hyphen-separated hexadecimal):

```
0193a4b2-8c90-7d4e-a123-456789abcdef
```

## Record Format

All records have the following common fields:

```json
{
  "timestamp": "2025-01-15T10:30:45.123456789Z",
  "type": "entry_type",
  "payload": { ... }
}
```

### Common Fields

| Field       | Type   | Required | Description                        |
| ----------- | ------ | -------- | ---------------------------------- |
| `timestamp` | string | Yes      | Timestamp in RFC3339Nano format    |
| `type`      | string | Yes      | Entry type (see below)             |
| `payload`   | object | Yes      | Type-specific data                 |

## Entry Types

### 1. session_meta

Session metadata. Always exists as the first entry in a file.

#### Payload Structure

```json
{
  "timestamp": "2025-01-15T10:30:00.000000000Z",
  "type": "session_meta",
  "payload": {
    "id": "0193a4b2-8c90-7d4e-a123-456789abcdef",
    "timestamp": "2025-01-15T10:30:00.000000000Z",
    "cwd": "/Users/alice/project",
    "originator": "cli",
    "cli_version": "1.2.0"
  }
}
```

#### Payload Fields

| Field         | Type   | Description                           |
| ------------- | ------ | ------------------------------------- |
| `id`          | string | Session UUID                          |
| `timestamp`   | string | Session start time                    |
| `cwd`         | string | Working directory                     |
| `originator`  | string | Session originator (usually "cli")    |
| `cli_version` | string | CLI version                           |

#### Legacy Format

Older logs may have metadata fields at the top level:

```json
{
  "id": "abc123",
  "timestamp": "2025-01-15T10:30:00Z",
  "cwd": "/Users/alice/project",
  "originator": "cli",
  "cli_version": "1.0.0"
}
```

Parsers support both formats.

### 2. response_item

Primary interaction messages between user and assistant.

#### Message Types

##### message

Normal text messages.

```json
{
  "timestamp": "2025-01-15T10:30:15.123Z",
  "type": "response_item",
  "payload": {
    "type": "message",
    "role": "user",
    "content": [
      {
        "type": "text",
        "text": "Write a function to calculate fibonacci numbers"
      }
    ]
  }
}
```

##### reasoning

Assistant's thinking process. May be encrypted.

```json
{
  "timestamp": "2025-01-15T10:30:20.456Z",
  "type": "response_item",
  "payload": {
    "type": "reasoning",
    "role": "assistant",
    "content": null,
    "summary": [
      {
        "type": "text",
        "text": "Encrypted reasoning (summary only)"
      }
    ]
  }
}
```

When `content` is null or empty, the parser falls back to the `summary` field.

##### function_call

Function calls (tool usage).

```json
{
  "timestamp": "2025-01-15T10:30:25.789Z",
  "type": "response_item",
  "payload": {
    "type": "function_call",
    "role": "assistant",
    "name": "write_file",
    "arguments": "{\"path\": \"fib.py\", \"content\": \"def fib(n):\\n  ...\"}"
  }
}
```

Or in `content` array format:

```json
{
  "timestamp": "2025-01-15T10:30:25.789Z",
  "type": "response_item",
  "payload": {
    "type": "function_call",
    "role": "assistant",
    "content": [
      {
        "type": "function_name",
        "text": "write_file"
      },
      {
        "type": "function_arguments",
        "text": "{\"path\": \"fib.py\", ...}"
      }
    ]
  }
}
```

##### function_call_output

Function execution results.

```json
{
  "timestamp": "2025-01-15T10:30:30.123Z",
  "type": "response_item",
  "payload": {
    "type": "function_call_output",
    "role": "tool",
    "output": "File written successfully"
  }
}
```

##### custom_tool_call / custom_tool_call_output

Custom tool invocations and results. Structure is the same as `function_call` / `function_call_output`.

#### Payload Fields

| Field       | Type   | Required    | Description                                      |
| ----------- | ------ | ----------- | ------------------------------------------------ |
| `type`      | string | Yes         | Message type (message, reasoning, function_call, etc.) |
| `role`      | string | Conditional | Message role (user, assistant, tool, system)     |
| `content`   | array  | Conditional | Array of ContentBlocks                           |
| `summary`   | array  | No          | Summary of encrypted content                     |
| `name`      | string | Conditional | Function name (for function_call)                |
| `arguments` | string | Conditional | Function arguments JSON string                   |
| `output`    | string | Conditional | Function output (for function_call_output)       |

### 3. event_msg

System-level events and notifications.

#### Event Types

##### token_count

Token usage statistics.

```json
{
  "timestamp": "2025-01-15T10:30:35.456Z",
  "type": "event_msg",
  "payload": {
    "type": "token_count",
    "info": {
      "total_token_usage": {
        "input_tokens": 1234,
        "cached_input_tokens": 500,
        "output_tokens": 567,
        "reasoning_output_tokens": 100,
        "total_tokens": 1801
      },
      "last_token_usage": {
        "input_tokens": 100,
        "output_tokens": 50,
        "total_tokens": 150
      }
    }
  }
}
```

##### user_message / agent_message

Message events from user or agent.

```json
{
  "timestamp": "2025-01-15T10:30:40.789Z",
  "type": "event_msg",
  "payload": {
    "type": "user_message",
    "content": "Message text here"
  }
}
```

Or using `message` field:

```json
{
  "timestamp": "2025-01-15T10:30:40.789Z",
  "type": "event_msg",
  "payload": {
    "type": "user_message",
    "message": "Message text here"
  }
}
```

##### agent_reasoning

Agent's reasoning process.

```json
{
  "timestamp": "2025-01-15T10:30:45.123Z",
  "type": "event_msg",
  "payload": {
    "type": "agent_reasoning",
    "text": "Analyzing the request..."
  }
}
```

##### turn_aborted

Indicates that a turn was aborted.

```json
{
  "timestamp": "2025-01-15T10:30:50.456Z",
  "type": "event_msg",
  "payload": {
    "type": "turn_aborted"
  }
}
```

#### Payload Fields

| Field     | Type   | Required    | Description                    |
| --------- | ------ | ----------- | ------------------------------ |
| `type`    | string | Yes         | Event type                     |
| `content` | string | Conditional | Message content                |
| `message` | string | Conditional | Alternative message field      |
| `text`    | string | Conditional | Text content                   |
| `info`    | object | Conditional | Detailed info for token_count  |

### 4. turn_context

Context information for a turn.

```json
{
  "timestamp": "2025-01-15T10:30:55.789Z",
  "type": "turn_context",
  "payload": {
    "turn_id": "turn-001",
    "context": "Starting new turn",
    "cwd": "/Users/alice/project",
    "model": "claude-sonnet-4-5-20250929",
    "effort": "medium",
    "summary": "User requested fibonacci function",
    "approval_policy": "auto"
  }
}
```

#### Payload Fields

| Field             | Type   | Required | Description                |
| ----------------- | ------ | -------- | -------------------------- |
| `turn_id`         | string | No       | Turn identifier            |
| `context`         | string | No       | Context description        |
| `cwd`             | string | No       | Working directory          |
| `model`           | string | No       | Model used                 |
| `effort`          | string | No       | Effort level               |
| `summary`         | string | No       | Turn summary               |
| `approval_policy` | string | No       | Approval policy            |

**Note**: If both `turn_id` and `context` are absent, the parser constructs alternative text from `model`, `effort`, and `cwd` fields.

## ContentBlock Structure

The `content` field is an array of ContentBlock objects:

```json
[
  {
    "type": "text",
    "text": "Content here"
  }
]
```

### ContentBlock Types

| Type                 | Description                  | Used In                       |
| -------------------- | ---------------------------- | ----------------------------- |
| `text`               | Plain text                   | message, reasoning, event_msg |
| `function_name`      | Function name                | function_call                 |
| `function_arguments` | Function arguments (JSON string) | function_call             |
| `function_output`    | Function execution result    | function_call_output          |
| `id`                 | Session ID                   | session_meta                  |
| `json`               | Raw JSON (fallback)          | Unknown structures            |

## Special Cases

### Encrypted Reasoning

When `content` is null in reasoning entries, the parser uses the `summary` field:

```go
if len(event.Content) == 0 && len(payload.Summary) > 0 {
    event.Content = decodeContentBlocks(payload.Summary)
}
```

### Legacy session_meta

Older log files may not have `type: "session_meta"` and instead have metadata fields directly at the top level. The parser detects these by checking for the presence of the `id` field.

### Empty Content

When `content` or `output` is absent:

- function_call: Constructs ContentBlocks from `name` and `arguments` fields
- function_call_output: Constructs ContentBlock from `output` field
- event_msg: Constructs from `content`, `message`, or `text` fields
- Others: Saves raw JSON as a json-type ContentBlock

### Unknown Payloads

When the parser encounters an unrecognized type, it saves the raw JSON as a ContentBlock:

```go
return []model.ContentBlock{{Type: "json", Text: string(raw)}}
```

This ensures logs can be read and rendered even when new entry types are added.

## Parsing Strategy

### 1. Buffer Size

The parser uses an 8MB buffer to handle large payloads (such as instructions blocks):

```go
const maxCapacity = 8 * 1024 * 1024
```

### 2. Timestamp Parsing

Timestamps prefer RFC3339Nano but fall back to RFC3339:

```go
if ts, err := time.Parse(time.RFC3339Nano, value); err == nil {
    return ts, nil
}
return time.Parse(time.RFC3339, value)
```

### 3. Content Normalization

All content is normalized to `ContentBlock` arrays, enabling consistent rendering:

```go
type ContentBlock struct {
    Type string
    Text string
}
```

This unifies different payload structures (`name`/`arguments` vs `content` arrays) under a single interface.

### 4. Fallback Order

The parser checks multiple fields to extract content:

**For event_msg**:

1. `content` field
2. `message` field
3. `text` field

**For response_item**:

1. `content` field
2. `summary` field (for reasoning)
3. `name`/`arguments` fields (for function_call)
4. `output` field (for function_call_output)

## Example Session

Example of a complete session:

```jsonl
{"timestamp":"2025-01-15T10:30:00.000Z","type":"session_meta","payload":{"id":"0193a4b2-8c90-7d4e-a123-456789abcdef","timestamp":"2025-01-15T10:30:00.000Z","cwd":"/Users/alice/project","originator":"cli","cli_version":"1.2.0"}}
{"timestamp":"2025-01-15T10:30:15.123Z","type":"response_item","payload":{"type":"message","role":"user","content":[{"type":"text","text":"Write a fibonacci function"}]}}
{"timestamp":"2025-01-15T10:30:20.456Z","type":"response_item","payload":{"type":"message","role":"assistant","content":[{"type":"text","text":"I'll write a fibonacci function for you."}]}}
{"timestamp":"2025-01-15T10:30:25.789Z","type":"response_item","payload":{"type":"function_call","role":"assistant","name":"write_file","arguments":"{\"path\":\"fib.py\",\"content\":\"def fib(n):\\n  if n <= 1:\\n    return n\\n  return fib(n-1) + fib(n-2)\"}"}}
{"timestamp":"2025-01-15T10:30:30.123Z","type":"response_item","payload":{"type":"function_call_output","role":"tool","output":"File written successfully"}}
{"timestamp":"2025-01-15T10:30:35.456Z","type":"event_msg","payload":{"type":"token_count","info":{"total_token_usage":{"input_tokens":1234,"output_tokens":567,"total_tokens":1801}}}}
```

This log contains:

1. Session metadata
2. User message
3. Assistant response
4. File write function call
5. Function output
6. Token usage statistics
